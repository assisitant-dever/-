from docx import Document
import os
from datetime import datetime

UPLOAD_DIR = "uploads/templates"
os.makedirs(UPLOAD_DIR, exist_ok=True)

# 模板数据
templates = [
    # 通知类
    {
        "type": "通知",
        "filename": "通知_人事部_员工培训.docx",
        "title": "关于举办员工培训的通知",
        "content": """人事部全体同仁：

为提升员工综合素质，本部门定于2025年9月10日在公司多功能厅举办员工培训。请各部门按时安排人员参加，并做好相关准备工作。

培训时间：2025年9月10日 09:00-12:00
培训地点：公司多功能厅
联系人：李华 人事部 12345678

人事部
2025年8月20日"""
    },
    {
        "type": "通知",
        "filename": "通知_行政部_办公环境整治.docx",
        "title": "关于办公环境整治的通知",
        "content": """全体员工：

为了营造整洁舒适的办公环境，公司行政部决定于2025年8月25日组织办公区域大扫除，请各部门积极配合。

整治时间：2025年8月25日 14:00-17:00
整治地点：各办公区域
联系人：行政部 张敏 87654321

行政部
2025年8月20日"""
    },
    {
        "type": "通知",
        "filename": "通知_IT部_系统升级.docx",
        "title": "关于公司内部系统升级的通知",
        "content": """全体员工：

公司内部管理系统将于2025年8月30日进行升级，请各部门提前保存相关数据，以免数据丢失。

升级时间：2025年8月30日 22:00-24:00
升级范围：财务、人事、项目管理系统
联系人：IT部 李雷 11223344

IT部
2025年8月20日"""
    },

    # 请示类
    {
        "type": "请示",
        "filename": "请示_财务部_采购办公设备.docx",
        "title": "关于采购办公设备的请示",
        "content": """公司领导：

为满足日常办公需求，财务部计划采购一批办公设备，包括打印机、扫描仪及办公桌椅。现特向公司领导请示批准采购预算及采购方案。

采购原因：提高部门办公效率
采购金额：约人民币 50,000 元
建议采购时间：2025年9月初

财务部
2025年8月20日"""
    },
    {
        "type": "请示",
        "filename": "请示_市场部_组织展会.docx",
        "title": "关于组织行业展会的请示",
        "content": """公司领导：

为拓展市场影响力，市场部计划于2025年10月组织参加行业展会，现特向公司领导请示批准展会参与及预算。

活动时间：2025年10月5日-10月7日
预算金额：约人民币 80,000 元
建议参与人员：市场部全体成员

市场部
2025年8月20日"""
    },
    {
        "type": "请示",
        "filename": "请示_研发部_采购实验设备.docx",
        "title": "关于采购实验设备的请示",
        "content": """公司领导：

为满足新项目研发需求，研发部计划采购一批实验设备，包括高精度仪器及耗材，现特向公司领导请示批准采购方案。

采购金额：约人民币 120,000 元
采购时间：2025年9月初
采购理由：保证项目按时完成

研发部
2025年8月20日"""
    },

    # 会议纪要类
    {
        "type": "会议纪要",
        "filename": "会议纪要_项目组_周例会.docx",
        "title": "项目组周例会纪要",
        "content": """会议时间：2025年8月18日 10:00-11:30
会议地点：项目组会议室
主持人：张经理
参会人员：张经理、李华、王强、赵敏

会议内容：
1. 项目进度汇报
2. 风险问题讨论
3. 下周工作安排

会议决议：
- 加快需求文档审批流程
- 下周完成接口设计

项目组
2025年8月18日"""
    },
    {
        "type": "会议纪要",
        "filename": "会议纪要_管理层_月度总结.docx",
        "title": "管理层月度总结会议纪要",
        "content": """会议时间：2025年8月10日 15:00-17:00
会议地点：公司会议室
主持人：总经理
参会人员：管理层全体成员

会议内容：
1. 部门月度工作总结
2. 存在问题讨论
3. 下月工作计划

会议决议：
- 加强跨部门协作
- 完善绩效考核机制

管理层
2025年8月10日"""
    },
    {
        "type": "会议纪要",
        "filename": "会议纪要_技术部_需求评审.docx",
        "title": "技术部需求评审会议纪要",
        "content": """会议时间：2025年8月15日 09:00-11:00
会议地点：技术部会议室
主持人：技术总监
参会人员：技术部全体成员

会议内容：
1. 新项目需求评审
2. 技术方案讨论
3. 风险与难点分析

会议决议：
- 修改部分接口设计
- 确认核心功能开发优先级

技术部
2025年8月15日"""
    }
]

# 生成 DOCX 文件
for tpl in templates:
    doc = Document()
    doc.add_heading(tpl["title"], level=1)
    doc.add_paragraph(tpl["content"])
    path = os.path.join(UPLOAD_DIR, tpl["filename"])
    doc.save(path)
    print(f"生成模板文件: {path}")

print("所有模板生成完成！")
